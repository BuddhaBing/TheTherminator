<!doctype html>
<html>

<head>
    <meta charset="UTF-8">
    <title>Thermostat</title>
    <script src="Thermostat.js"></script>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <script src="https://code.jquery.com/jquery-3.1.1.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>

    <script>
        $(document).ready(function() {
            $thermostat = new Thermostat;
            var $oneDegree = (100 / ($thermostat._maxTemp - $thermostat._minTemp));
            var $currentPercent = ($thermostat._maxTemp - $thermostat._currentTemp) * $oneDegree;
            var $bubbleColor = "orange";
            thermBackground = function() {
                $(".thermometer").css("background", "-webkit-linear-gradient(top, #fff 0%, #fff " + $currentPercent + "%, " + $bubbleColor + " " + $currentPercent + "%, " + $bubbleColor + " 100%");
            };
            thermBackground()
            bubbleBackground = function() {
                $(".thermometer:before").css("background", $bubbleColor);
                if ($thermostat._currentTemp < 18) {
                    $bubbleColor = "green";
                    $('head').append('<style>.thermometer:before, .thermometer:after{background:' + $bubbleColor + '!important;}</style>');
                } else if ($thermostat._currentTemp < 25) {
                    $bubbleColor = "orange";
                    $('head').append('<style>.thermometer:before, .thermometer:after{background:' + $bubbleColor + '!important;}</style>');
                } else {
                    $bubbleColor = "red";
                    $('head').append('<style>.thermometer:before, .thermometer:after{background:' + $bubbleColor + '!important;}</style>');
                };
            };
            $(".temp-down").click(function(event) {
                $currentPercent += $oneDegree;
                $thermostat.down(1);
                if ($thermostat._currentTemp >= $thermostat._minTemp) {
                    bubbleBackground();
                    thermBackground();
                    $(".thermometer").html($thermostat._currentTemp + "&deg;C");
                } else {
                    $(".error").html("Cannot lower temperature below " + $thermostat._minTemp);
                };
            });
            $(".temp-up").click(function(event) {
                $currentPercent -= $oneDegree;
                $thermostat.up(1);
                if ($thermostat._currentTemp <= $thermostat._maxTemp) {
                    bubbleBackground();
                    thermBackground();
                    $(".thermometer").html($thermostat._currentTemp + "&deg;C");
                } else {
                    $(".error").html("Cannot exceed max temperature of " + $thermostat._maxTemp);
                };
            });
            $(".temp-reset").click(function(event) {
                $currentPercent = 35;
                $thermostat.reset();
                bubbleBackground();
                thermBackground();
                $(".thermometer").html($thermostat._currentTemp + "&deg;C");
            });
            $(".power-saving").click(function(event) {

            });


        });
    </script>
    <div class="topbar">
        <h1>Thermostat</h1>
        <div class="error"></div>
    </div>
    <main>
        <div class="left">
            <div class="temp-controls">
                <button class="temp-down">
                    DOWN
                </button>
                <button class="temp-up">
                    UP
                </button>
                <button class="temp-reset">
                    RESET
                </button>
            </div>
            <div class="power-saving">
                <button class="power-saving-butt">
                    POWER SAVING ON/OFF
                </button>
            </div>
        </div>
        <div class="right">
            <div class="display">
                <div class="thermometer">20&deg;C</div>
                CURRENT TEMP MAX TEMP MIN TEMP ENERGY USAGE
            </div>
        </div>
    </main>

</body>

</html>
